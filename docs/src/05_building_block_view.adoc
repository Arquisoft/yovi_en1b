[[section-building-block-view]]
== Building Block View

This section describes the decomposition of the GameY system into its principal building blocks, showing their internal structure and relationships. The system is detailed across two levels: Level 1 shows the overall system components, and Level 2 zooms into the internal structure of each specific component.

=== Whitebox Overall System (Level 1)

Here we describe the decomposition of the overall GameY system.

*Overview Diagram*

[plantuml, "level-1-overall", "png"]
----
@startuml
actor "User" as user

package "GameY System" {
  component [webapp\n(React/Vite)] as webapp
  component [users\n(Node.js/Express)] as users
  component [gamey\n(Rust Engine)] as gamey
}

user --> webapp : Interacts via browser
webapp --> users : HTTP (Port 3000)
webapp --> gamey : HTTP (Port 4000)
@enduml
----

*Motivation*

The system is decomposed into three main building blocks to separate concerns:
* The user interface (frontend) is isolated to provide a responsive SPA (Single Page Application).
* The user handling is separated into its own microservice to independently manage registrations and user logic.
* The game logic is encapsulated in a high-performance Rust engine, ensuring fast execution for bot AI and game state validation.

*Contained Building Blocks*

|===
| Name | Responsibility

| *webapp*
| Frontend web application. Renders the user interface, handles form submissions (like RegisterForm), and communicates with backend services to display data.

| *users*
| Backend REST API service. Currently responsible for handling user registration requests and returning welcome messages.

| *gamey*
| Core game engine and bot service. Responsible for managing the game state, board coordinates, valid actions, notations, and bot logic.
|===

=== Level 2

This level zooms into the internal structure of the three main building blocks defined in Level 1.

==== Whitebox: webapp

*Overview Diagram*

[plantuml, "level-2-webapp", "png"]
----
@startuml
package "webapp (React)" {
  component [App.tsx] as app
  component [RegisterForm.tsx] as form
}

app --> form : Renders
form --> [External:\nusers service] : fetch(/createuser)
@enduml
----

*Contained Building Blocks*

|===
| Name | Responsibility

| *App.tsx*
| The root React component that serves as the entry point for the frontend application.

| *RegisterForm.tsx*
| A specific UI component that renders the registration form, captures user input (username), and sends the HTTP POST request to the users service API.
|===


==== Whitebox: users

*Overview Diagram*

[plantuml, "level-2-users", "png"]
----
@startuml
package "users (Node.js)" {
  component [users-service.js] as service
  portin "Port 3000" as port
}

port --> service : HTTP POST /createuser
service --> [External:\nwebapp] : JSON Response
@enduml
----

*Contained Building Blocks*

|===
| Name | Responsibility

| *users-service.js*
| The main Express server file. It defines the API endpoints, specifically the /createuser route. It currently simulates a database delay (1000ms) and processes the JSON response sent back to the client.
|===


==== Whitebox: gamey

*Overview Diagram*

[plantuml, "level-2-gamey", "png"]
----
@startuml
package "gamey (Rust)" {
  component [main.rs / lib.rs] as main
  component [web] as web_module
  component [core] as core_module
  component [bot] as bot_module
  component [notation] as notation_module
}

main --> web_module
main --> core_module
core_module <--> bot_module
core_module <--> notation_module
@enduml
----

*Contained Building Blocks*

|===
| Name | Responsibility

| *main.rs / lib.rs*
| Entry point and library exports for the Rust application. It initializes the engine (e.g., HTTP server mode on Port 4000).

| *web*
| Manages the web interface components and server routing.

| *core*
| Contains the core game logic, including actions, coordinates, game state, and player management.

| *bot*
| Implements the bot registry and automated player logic.

| *notation*
| Provides parsers and support for game notation formats (YEN, YGN).
|===